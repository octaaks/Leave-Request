@{
    Layout = "~/Views/Shared/_HomeLayout.cshtml";
}

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Register</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="~/adminlte/plugins/fontawesome-free/css/all.min.css">
    <!-- icheck bootstrap -->
    <link rel="stylesheet" href="~/adminlte/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="~/adminlte/dist/css/adminlte.min.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" 
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/css/bootstrap-datepicker.css">
</head>
<body class="hold-transition login-page d-flex justify-content-center">
    <div class="card card-info m-auto mt-5 mb-5" style="width:75%;">
        <div class="card-header text-center text-white">
            <h2>Register</h2>
        </div>
        <div class="card-body">
                <form id="contactform" class="needs-validation" novalidate>

                    <div class="form-row">
                        <div class="col-4 mb-3">
                            <label for="inputId">Employee ID</label>
                            <div class="input-group">
                                <input type="text" name="nik" class="form-control" id="inputId" placeholder="Employee ID"
                                       aria-describedby="inputGroupPrepend" autocomplete="off" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please type your employee ID.
                                </div>
                            </div>
                        </div>
                        <div class="col-8 mb-3">
                            <label for="inputName">Name</label>
                            <input type="text" name="firstname" class="form-control" id="inputName" placeholder="Name" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                            <div class="invalid-feedback">
                                Please type your name.
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-md mb-3">
                            <label for="inputEmail">Email</label>
                            <div class="input-group">
                                <input type="email" name="email" class="form-control" id="inputEmail" placeholder="Email"
                                       aria-describedby="inputGroupPrepend" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please type an active email.
                                </div>
                            </div>
                        </div>
                        <div class="col-md mb-3">
                            <label for="inputPassword">Password</label>
                            <div class="input-group">
                                <input type="password" name="password" class="form-control" id="inputPassword" placeholder="Password"
                                       pattern="^(?=.?[A-Z])(?=.?[a-z])(?=.*?[0-9]).{8,}$" aria-describedby="inputGroupPrepend" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Min 8 char, contain lowercase, uppercase, & number.
                                </div>
                            </div>
                        </div>
                        <div class="col-md mb-3">
                            <label for="inputPhone">Phone</label>
                            <div class="input-group">
                                <input type="number" name="phone" class="form-control" id="inputPhone" placeholder="Phone"
                                       aria-describedby="inputGroupPrepend" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please type a phone number.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-md mb-3">
                            <label for="inputGender">Gender</label>
                            <div class="input-group">

                                <select id="inputGender" class="custom-select" required>
                                    <option value=0>Male</option>
                                    <option value=1>Female</option>
                                </select>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please insert your gender.
                                </div>
                            </div>
                        </div>
                   
                        <div class="col mb-3">
                            <label for="inputAddress">Address</label>
                            <input type="text" name="firstname" class="form-control" id="inputAddress" placeholder="Address" value="" required>
                            <div class="invalid-feedback">
                                Please insert your address.
                            </div>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                        </div>
                    
                        <div class="col-md mb-3">
                            <label for="inputReligion">Religion</label>
                            <div class="input-group">
                                <select class="custom-select my-1 mr-sm-2" id="inputReligion" placeholder="Religion" required>
                                </select>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please select your religion.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-md mb-3">
                            <label for="inputBirthDate">BirthDate</label>
                            <div class="input-group">
                                <input type="date" class="form-control" data-date-format="yyyy-mm-dd" id="inputBirthDate"
                                       placeholder="Birth Date" autocomplete="off" autocorrect="off"
                                       autocapitalize="off" spellcheck="false" required>
                                <div class="input-group-addon">
                                    <span class="glyphicon glyphicon-th"></span>
                                </div>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please insert your birthdate.
                                </div>
                            </div>
                        </div>
                        <div class="col-md mb-3">
                            <label for="inputJoinDate">Join Date</label>
                            <div class="input-group">
                                <input type="date" class="form-control" data-date-format="yyyy-mm-dd" id="inputJoinDate"
                                       placeholder="Birth Date" autocomplete="off" autocorrect="off"
                                       autocapitalize="off" spellcheck="false" required>
                                <div class="input-group-addon">
                                    <span class="glyphicon glyphicon-th"></span>
                                </div>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please insert join date.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="col-md mb-3">
                            <label for="inputJob">Position</label>
                            <div class="input-group">
                                <select class="custom-select my-1 mr-sm-2" id="inputJob" placeholder="Position" required>
                                </select>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please select your position.
                                </div>
                            </div>
                        </div>
                        <div class="col-md mb-3">
                            <label for="inputSalary">Salary</label>
                            <div class="input-group">
                                <input type="number" name="salary" class="form-control" id="inputSalary" placeholder="Salary"
                                       aria-describedby="inputGroupPrepend" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                                <div class="invalid-feedback">
                                    Please insert your salary.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <div class="form-check">
                            <input class="form-check-input" name="check" type="checkbox" value="" id="invalidCheck" required>
                            <label class="form-check-label" for="invalidCheck">
                                Agree to terms and conditions
                            </label>
                            <div class="invalid-feedback">
                                You must agree before submitting.
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" type="submit" id="btnSubmit">Submit form</button>
                    <p class="mb-1 mt-3 float-right">
                        Already have an account? <a asp-controller="Home" asp-action="Login">Log In Here!</a>
                    </p>
                </form>
            </div>
        </div>
        <!-- /.login-card-body -->
    <!-- /.login-box -->
    <!-- jQuery -->
    <script src="~/adminlte/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="~/adminlte/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="~/adminlte/dist/js/adminlte.min.js"></script>
</body>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment-with-locales.min.js" integrity="sha512-LGXaggshOkD/at6PFNcp2V2unf9LzFq6LE+sChH7ceMTDP0g2kn6Vxwgg7wkPP7AAtX+lmPqPdxB47A0Nz0cMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.8.0/js/bootstrap-datepicker.js"></script>
<script>
    $(document).ready(function () {

        $(function () {
            $("#inputBirthDate").datepicker();
        });

        $(function () {
            $("#inputJoinDate").datepicker();
        });

        //get all jobs
        $.ajax({
            url: "/jobs/getall"
        }).done((result) => {
            var text = "";
            console.log(result);
            $.each(result, function (key, val) {
                text += `
                <option value="${val.id}">${val.title}</option>
            `
            });
            $("#inputJob").html(text);
        }).fail((result) => {
            console.log(result);
        });

        //get all religions
        $.ajax({
            url: "/religions/getall"
        }).done((result) => {
            var text = "";
            console.log(result);
            $.each(result, function (key, val) {
                text += `
                <option value="${val.id}">${val.name}</option>
            `
            });
            $("#inputReligion").html(text);
        }).fail((result) => {
            console.log(result);
        });

        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');

                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong!',
                            })
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === true) {
                            event.preventDefault();

                            var obj = {

                                //"Id": 12,
                                //"Name": "Cumi Cumi",
                                //"Address": "Bandung, Indonesia",
                                //"Gender": 1,
                                //"Phone": "0812322126007",
                                //"BirthDate": "1994-05-11",
                                //"Salary": 1000000,
                                //"JoinDate": "2020-10-05",
                                //"ReligionId": 1,
                                //"JobId": 1,
                                //"Email": "ciciici7@gmail.com",
                                //"Password": "Qwerty007"

                                "Id": parseInt($('#inputId').val()),
                                "Name": $('#inputName').val(),
                                "Address": $('#inputAddress').val(),
                                "Gender": parseInt($('#inputGender').val()),
                                "Phone": $('#inputPhone').val(),
                                "BirthDate": moment($('#inputBirthDate').val()).format("YYYY-MM-DD"),
                                "Salary": parseInt($('#inputSalary').val()),
                                "JoinDate": moment($('#inputJoinDate').val()).format("YYYY-MM-DD"),
                                "ReligionId": parseInt($('#inputReligion').val()),
                                "JobId": parseInt($('#inputJob').val()),
                                "Email": $('#inputEmail').val(),
                                "Password": $('#inputPassword').val()

                            };

                            var data = JSON.stringify(obj);

                            register(data);
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        function register(data) {
            console.log(data);

            $.ajax({
                type: "POST",
                url: "/accounts/register",
                data: data,
                traditional: true,
                contentType: 'application/json',
                dataType: "json",

            }).done((result) => {
                console.log(result);
                //$('#registerModal').modal('toggle');
                //$('#contactform')[0].reset();

                //Swal.fire(
                //    'Congratulations!',
                //    'Register succeed!'
                //);
                //mt.ajax.reload(function (json) {
                //    $('#table_id').val(json.lastInput);
                //});
            }).fail((result) => {
                console.log("fail");
                console.log(result);
            });
        };
    });
</script>
